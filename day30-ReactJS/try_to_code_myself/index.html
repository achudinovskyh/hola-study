<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Thinking in React</title>
    <script src="https://unpkg.com/react@15.3.0/dist/react.js"></script>
    <script src="https://unpkg.com/react-dom@15.3.0/dist/react-dom.js"></script>
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
    <script src="https://unpkg.com/jquery@3.1.0/dist/jquery.min.js"></script>
    <script src="https://unpkg.com/remarkable@1.6.2/dist/remarkable.min.js"></script>
</head>
<body>
<div id="container"></div>

<script type="text/babel">

//    var ProductCategoryRow = React.createClass({
//        render: function () {
//            return (<tr>
//                <th colSpan="2">{this.props.category}</th>
//            </tr>);
//        }
//    });
//
//    var ProductRow = React.createClass({
//        render: function () {
//            var name = this.props.product status ?
//                    this.props.product.name :
//                    <span style={{color: 'red'}}>
//        {this.props.product.name}
//      </span>;
//            return (
//                    <tr>
//                        <td>{name}</td>
//                        <td>{this.props.product.price}</td>
//                    </tr>
//            );
//        }
//    });
//
//    var ProductTable = React.createClass({
//        render: function () {
//            var rows = [];
//            var lastCategory = null;
//            this.props.products.forEach(function (product) {
//                if (product.name.indexOf(this.props.filterText) === -1 || (!product status && this.props.inStockOnly)) {
//                    return;
//                }
//                if (product.category !== lastCategory) {
//                    rows.push(<ProductCategoryRow category={product.category} key={product.category}/>);
//                }
//                rows.push(<ProductRow product={product} key={product.name}/>);
//                lastCategory = product.category;
//            }.bind(this));
//            return (
//                    <table>
//                        <thead>
//                        <tr>
//                            <th>Name</th>
//                            <th>Price</th>
//                        </tr>
//                        </thead>
//                        <tbody>{rows}</tbody>
//                    </table>
//            );
//        }
//    });
//
//    var SearchBar = React.createClass({
//        handleChange: function () {
//            this.props.onUserInput(
//                    this.refs.filterTextInput.value,
//                    this.refs.inStockOnlyInput.checked
//            );
//        },
//        render: function () {
//            return (
//                    <form>
//                        <input
//                                type="text"
//                                placeholder="Search..."
//                                value={this.props.filterText}
//                                ref="filterTextInput"
//                                onChange={this.handleChange}
//                        />
//                        <p>
//                            <input
//                                    type="checkbox"
//                                    checked={this.props.inStockOnly}
//                                    ref="inStockOnlyInput"
//                                    onChange={this.handleChange}
//                            />
//                            {' '}
//                            Only show products in stock
//                        </p>
//                    </form>
//            );
//        }
//    });
//
//    var FilterableProductTable = React.createClass({
//        getInitialState: function () {
//            return {
//                filterText: '',
//                inStockOnly: false
//            };
//        },
//
//        handleUserInput: function (filterText, inStockOnly) {
//            this.setState({
//                filterText: filterText,
//                inStockOnly: inStockOnly
//            });
//        },
//
//        render: function () {
//            return (
//                    <div>
//                        <SearchBar
//                                filterText={this.state.filterText}
//                                inStockOnly={this.state.inStockOnly}
//                                onUserInput={this.handleUserInput}
//                        />
//                        <ProductTable
//                                products={this.props.products}
//                                filterText={this.state.filterText}
//                                inStockOnly={this.state.inStockOnly}
//                        />
//                    </div>
//            );
//        }
//    });
    const  ENTER = 13;

    let FilterPanel = React.createClass({
        render: function () {
            return (
                <div>
                    <button type="button">All</button>
                    <button type="button">Active</button>
                    <button type="button">Finished</button>
                </div>
            );
        }
    });

    let TaskRow = React.createClass({
        render: function () {
           return (
               <li>
                   <input type="checkbox" defaultChecked={this.props.taskFields.status}/>
                   <span>{this.props.taskFields.task}</span>
               </li>
           );
        }
    });

    let TasksList = React.createClass({
        render: function () {
            let taskRows = [];
            this.props.tasks.forEach(function (task) {
                taskRows.push(<TaskRow taskFields={task} key={task.id}/>)
            });
            return (
                <div>
                    <ul>
                        {taskRows}
                    </ul>
                </div>
            );
        }
    });

    let InputTaskField = React.createClass({
        handleKeyUp: function (e) {
            if(e.keyCode === ENTER){
                this.props.onSubmit(e.target.value)
            }
        },
        render: function () {
            return (
                <div>
                    <input type="checkbox"/>
                    <input type="text" onKeyUp={this.handleKeyUp}/>
                </div>
            );
        }
    });

    let TodosTable = React.createClass({
        addNewTask: function (task) {
            let newTask = {
                id: this.props.tasks.length,
                task: task,
                status: false
            };
            tasks.push(newTask);
            this.setState({tasks: {tasks}});
        },
        render: function () {
            return (
                    <div>
                        <InputTaskField onSubmit={this.addNewTask}/>
                        <TasksList tasks={this.props.tasks} />
                        <FilterPanel />
                    </div>
            );
        }
    });

    let tasks = [
        {id: 0, task: '1sdfsdf', status: true},
        {id: 1, task: '2dsdasd', status: true},
        {id: 2, task: '3fsdfsdf', status: false},
        {id: 3, task: '4fsdfsdfsd', status: true},
        {id: 4, task: '5fsdfsdfs', status: false},
        {id: 5, task: '6sdfsdfsdf', status: true}
    ];

    ReactDOM.render(
            <TodosTable tasks={tasks}/>,
            document.getElementById('container')
    );
</script>
</body>
</html>
